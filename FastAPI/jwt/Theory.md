## Різниця між валідацією та верифікацією JWT

У контексті безпеки `JSON Web Token (JWT)` ці два поняття часто плутають, але вони відповідають за різні завдання:

**Валідація JWT** — це перевірка, що токен правильно сформований і містить коректні дані:

- **Структура:** три частини (`header`, `payload`, `signature`), розділені крапками.

- **Формат:** правильне кодування (`Base64URL`) та наявність очікуваних полів.

- **Твердження (claims)**: перевірка `exp`, `nbf`, `iat` тощо, щоб токен не був прострочений чи використаний передчасно.

**Верифікація JWT** — це підтвердження, що токен автентичний і не був змінений:

- **Підпис:** перевірка, що `signature` відповідає заголовку й корисному навантаженню (`payload`), використовуючи правильний алгоритм (`HMAC`, `RSA`, `ECDSA`) та ключ.

- **Емітент:** `iss` відповідає очікуваному джерелу.

- **Аудиторія:** `aud` збігається з тим, для кого призначено токен.

Як це виглядає на практиці:

- Валідація гарантує, що токен має правильну форму та зміст.

- Верифікація гарантує, що токен справжній та незмінений.

Часто ці етапи об’єднують під загальним словом «перевірка токена», але розуміння різниці допомагає чіткіше будувати безпеку.

## Різниця між декодуванням та кодуванням `JWT`

Кодування `JWT` передбачає перетворення `header` та `payload` в компактний, безпечний для URL формат. `header`, 
```json
{
  "alg": "HS256",
  "typ": "JWT"
}
```
в якому міститься алгоритм підпису та тип токена, та `payload`, 
```json
{
  "sub": "1234567890",
  "name": "John Doe",
  "exp": 1754999387,
  "iat": 1754394587,
  "jti": "dbe2ff531cba4e1481c1ea3dfaed0413",
}
```
який містить такі `claims`, як `sub`, `exp` та `iss`, конвертуються в `JSON`, а потім кодуються в `Base64URL`. 

Ці закодовані частини потім розділяються крапкою `xxxxx.yyyyy.zzzzz`, після чого генерується `signature` за допомогою алгоритму, зазначеного в `header`, із секретним (`secret`) або приватним (`private`) ключем. Цей підпис (`signature`) також кодується в `Base64URL`,
```txt
HMACSHA256(
  base64UrlEncode(header) + "." +
  base64UrlEncode(payload),
  secret)
```
що в результаті створює `JWT`, який представляє собою токен у форматі, придатному для передачі або зберігання.

Декодування `JWT` це зворотній процес, який конвертує закодований в `Base64URL` `header` і `payload` назад у `JSON`, що дозволяє читати їх без додаткових інструментів. Однак, «декодування» в цьому контексті часто включає перевірку підпису токена (`signature`). Цей крок перевірки включає повторний підпис декодованого `header` і `payload` тим самим алгоритмом (`HS256`) і ключем (`SECRET_KEY`), що використовувалися спочатку для його кодування, а потім порівняння цього нового підпису з тим, що міститься в `JWT`. Якщо вони однакові, то це означає цілісність і автентичність токена і гарантує, що він не був змінений (підроблений) з моменту його створення.